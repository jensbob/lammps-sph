LAMMPS (9 Nov 2011)
echo               both
dimension          3
units              si
atom_style   hybrid  bond meso
boundary          p p p
# create simulation box
#3D box
variable           L  equal 5e-4
region             box block 0.0 ${L}  0.0 ${L} 0.0 ${L} units box
region             box block 0.0 0.0005  0.0 ${L} 0.0 ${L} units box
region             box block 0.0 0.0005  0.0 0.0005 0.0 ${L} units box
region             box block 0.0 0.0005  0.0 0.0005 0.0 0.0005 units box
read_data           poly3d.txt
  1 = max bonds/atom
  orthogonal box = (0 0 0) to (0.0005 0.0005 0.0005)
  1 by 2 by 3 processor grid
  8000 atoms
  8000 velocities
  2375 bonds
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors

special_bonds   lj 1 1 1
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors
bond_style fene
bond_coeff 1 3e-5 5e-5  0 0


mass               1 3.90625e-12
set                group all meso_rho 1000.0
  8000 settings made for meso_rho

# smothing length
variable          h equal 6.5e-5

# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s

variable           sdpd_temp index 1e9
pair_style         hybrid  sdpd
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 6.5e-05 ${sdpd_temp}
pair_coeff         * *    sdpd 1000 1e-3 1.0e-3 6.5e-05 1e9

compute            rho_peratom all meso_rho/atom
compute            e_peratom all meso_e/atom
compute            ke_peratom all ke/atom
compute            esph all reduce sum c_e_peratom
compute            ke all ke
compute            sdpd_kin all temp
variable           etot equal c_ke+c_esph


# do full time integration 
fix                integrate_fix_full all meso

dump               dump_id all custom 100 dump*.dat id type x y z vx vy vz c_rho_peratom
#dump the unwrapped coordinate of particles
dump               dumpreal_id all custom 100 dumpreal*.dat id type xu yu zu vx vy vz c_rho_peratom

dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8
dump_modify        dumpreal_id first yes
dump_modify        dumpreal_id sort id
dump_modify        dumpreal_id pad 8

thermo_style       custom step c_sdpd_kin
thermo_modify      norm no
thermo             1000
dump imgDump all image 100 image.*.jpg type type atom no bond atom 5e-6 adiam 1e-5 view 60 60 zoom 1.3  box yes 0.01
dump_modify        imgDump pad 9
variable           dt index 1e-9
variable           vkin equal c_sdpd_kin
fix extra all print 1000 "${vkin}" file "kin.dat.dt"


neighbor           3.0e-6 bin
timestep           ${dt}
timestep           1e-9
run                4000000
WARNING: Use special bonds = 0,1,1 with bond style fene (bond_fene.cpp:189)
Memory usage per processor = 3.68137 Mbytes
Step sdpd_kin 
       0            0 
1228158.928
    1000    1228158.9 
2459749.403
    2000    2459749.4 
3717023.024
    3000      3717023 
4933461.787
    4000    4933461.8 
6172941.947
    5000    6172941.9 
7379674.777
    6000    7379674.8 
8580366.704
    7000    8580366.7 
9802521.097
    8000    9802521.1 
11001381.47
    9000     11001381 
12289636.21
   10000     12289636 
13510889.41
   11000     13510889 
14742576.14
   12000     14742576 
15882447.38
   13000     15882447 
17227733.15
   14000     17227733 
18614513.12
   15000     18614513 
19863008.57
   16000     19863009 
21113257.66
   17000     21113258 
22475177.05
   18000     22475177 
23790558.46
   19000     23790558 
24987779.08
   20000     24987779 
26189803.68
   21000     26189804 
27567114.64
   22000     27567115 
28828458.32
   23000     28828458 
30204949.05
   24000     30204949 
31507268.72
   25000     31507269 
32874163.73
   26000     32874164 
34277040.88
   27000     34277041 
35444931
   28000     35444931 
36595372.99
   29000