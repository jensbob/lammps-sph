LAMMPS (9 Nov 2011)
echo               both
dimension          3
units              si
atom_style   hybrid  bond meso
boundary          p p p
# create simulation box
#3D box
include           3d-vars.lmp
variable           dx   equal 2.5e-5
variable           Lx    equal  20*${dx}
variable           Lx    equal  20*2.5e-05
variable           Ly    equal  20*${dx}
variable           Ly    equal  20*2.5e-05
variable           Lz    equal  20*${dx}
variable           Lz    equal  20*2.5e-05
variable           sdpd_rho equal 1000
variable           sdpd_c equal 3e-1
variable           sdpd_eta equal 1.5e-2
variable           sdpd_mu  equal ${sdpd_eta}/${sdpd_rho}
variable           sdpd_mu  equal 0.015/${sdpd_rho}
variable           sdpd_mu  equal 0.015/1000
variable          h equal 2.7*${dx}
variable          h equal 2.7*2.5e-05
variable          gx equal 6.12
variable          Nfreq equal 1000
variable          r0       equal 1.4*${dx}
variable          r0       equal 1.4*2.5e-05
variable          H        equal 5.3e-4
variable          sdpd_mass equal ${dx}*${dx}*${dx}*${sdpd_rho}
variable          sdpd_mass equal 2.5e-05*${dx}*${dx}*${sdpd_rho}
variable          sdpd_mass equal 2.5e-05*2.5e-05*${dx}*${sdpd_rho}
variable          sdpd_mass equal 2.5e-05*2.5e-05*2.5e-05*${sdpd_rho}
variable          sdpd_mass equal 2.5e-05*2.5e-05*2.5e-05*1000
variable          def_rate      equal 2e2
region             box block 0.0 ${Lx}  0.0 ${Ly} 0.0 ${Lz} units box
region             box block 0.0 0.0005  0.0 ${Ly} 0.0 ${Lz} units box
region             box block 0.0 0.0005  0.0 0.0005 0.0 ${Lz} units box
region             box block 0.0 0.0005  0.0 0.0005 0.0 0.0005 units box
read_data           poly3d.txt
  1 = max bonds/atom
  orthogonal box = (0 0 0) to (0.0005 0.0005 0.0005)
  1 by 1 by 2 processor grid
  8000 atoms
  8000 velocities
  3600 bonds
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors

special_bonds   lj 1 1 1
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors
bond_style fene
bond_coeff 1  ${H} ${r0} 0 0
bond_coeff 1  0.00053 ${r0} 0 0
bond_coeff 1  0.00053 3.5e-05 0 0


mass               1 ${sdpd_mass}
mass               1 1.5625e-11
set                group all meso_rho ${sdpd_rho}
set                group all meso_rho 1000
  8000 settings made for meso_rho


# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s
pair_style         hybrid/overlay sph/rhosum 1 sdpd
variable           sdpd_temp index 1e9
pair_coeff         * * sph/rhosum   ${h}
pair_coeff         * * sph/rhosum   6.75e-05
pair_coeff         * *    sdpd ${sdpd_rho} ${sdpd_c} ${sdpd_eta} ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 ${sdpd_c} ${sdpd_eta} ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 0.3 ${sdpd_eta} ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 0.3 0.015 ${h} ${sdpd_temp}
pair_coeff         * *    sdpd 1000 0.3 0.015 6.75e-05 ${sdpd_temp}
pair_coeff         * *    sdpd 1000 0.3 0.015 6.75e-05 1e9

compute            rho_peratom all meso_rho/atom
compute            e_peratom all meso_e/atom
compute            ke_peratom all ke/atom
compute            esph all reduce sum c_e_peratom
compute            ke all ke
compute            sdpd_kin all temp
variable           etot equal c_ke+c_esph

#compute            sdpd_kin all temp
#compute            rho_peratom all meso_rho/atom

# do full time integration for shear driver and fluid, but keep walls stationary
fix                integrate_fix_full all meso
thermo_style       custom step c_sdpd_kin
thermo_modify      norm no
thermo            10
communicate        single vel yes
neighbor           3.0e-6 bin
neigh_modify       delay 0 every 1
include            settimestep.lmp
variable dt_eta equal 1/8.0*${dx}*${dx}/(${sdpd_mu})
variable dt_eta equal 1/8.0*2.5e-05*${dx}/(${sdpd_mu})
variable dt_eta equal 1/8.0*2.5e-05*2.5e-05/(${sdpd_mu})
variable dt_eta equal 1/8.0*2.5e-05*2.5e-05/(1.5e-05)
variable dt_c equal 1/4.0*${dx}/${sdpd_c}
variable dt_c equal 1/4.0*2.5e-05/${sdpd_c}
variable dt_c equal 1/4.0*2.5e-05/0.3

if "${dt_c}>${dt_eta}" then "variable dt equal ${dt_eta}" else "variable dt equal ${dt_c}"
variable dt equal ${dt_eta}
variable dt equal 5.208333333e-06
print "(settimestep) dt_c dt_eta dt ${dt_c} ${dt_eta} ${dt}"
(settimestep) dt_c dt_eta dt 2.083333333e-05 5.208333333e-06 5.208333333e-06
timestep           ${dt}
timestep           5.208333333e-06

run 100
WARNING: Use special bonds = 0,1,1 with bond style fene (bond_fene.cpp:189)
Memory usage per processor = 6.82292 Mbytes
Step sdpd_kin 
       0            0 
      10 1.0249085e+09 
      20 1.1708368e+09 
      30 1.3049838e+09 
      40 1.4172609e+09 
      50 1.4444768e+09 
      60 1.3881484e+09 
      70 1.2677409e+09 
      80 1.1435696e+09 
      90 1.0410879e+09 
     100 9.9597743e+08 
Loop time of 42.602 on 2 procs for 100 steps with 8000 atoms

Pair  time (%) = 39.1792 (91.9657)
Bond  time (%) = 0.0101198 (0.0237543)
Neigh time (%) = 1.25778 (2.9524)
Comm  time (%) = 2.12441 (4.98665)
Outpt time (%) = 0.00049448 (0.0011607)
Other time (%) = 0.0299612 (0.0703283)

Nlocal:    4000 ave 4029 max 3971 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:    5906 ave 5911 max 5901 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:    190242 ave 191754 max 188730 min
Histogram: 1 0 0 0 0 0 0 0 0 1
FullNghs: 380484 ave 383417 max 377551 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 760968
Ave neighs/atom = 95.121
Ave special neighs/atom = 2.4
Neighbor list builds = 45
Dangerous builds = 0
