echo               both
dimension          2
units              si
atom_style         meso
boundary          p p p

# create simulation box
#2D box
variable           L equal 1e-3
variable           L2 equal 2.0*${L}

region             box block 0.0000e-3 ${L2}  0.0000e-3 ${L} -1.0e-6 1.0e-6 units box
create_box         1 box

variable          h equal 1e-4
lattice            sq ${h}
create_atoms       1 box  units box

mass               1 6.25E-6
set                group all meso_rho 1000.0

# use Tait's EOS in combination with Morris' laminar viscosity.
# We set rho_0 = 1000 kg/m^3, c = 0.1 m/s, h = 6.5e-5 m.
# The dynamic viscosity is set to 1.0e-3 Pa s, corresponding to a kinematic viscosity of 1.0e-6 m^2/s
#The temperature is set to 1e5C.
variable          soundspead equal 1e-4
variable          sdpd_temp equal 0.0
variable           sdpd_eta index 1e-3
pair_style         hybrid/overlay sph/rhosum 1 sdpd
pair_coeff         * *    sph/rhosum   ${h}
pair_coeff         * *    sdpd 1000 ${soundspead} ${sdpd_eta} ${h} ${sdpd_temp}

compute            rho_peratom all meso_rho/atom
compute            sdpd_kin all temp

fix                integrate_fix_full all meso
dump               dump_id all custom 100 dump.*.dat id type x y vx vy c_rho_peratom
thermo             10

variable           ntime equal 2000
variable           gy equal 1.0
variable fy atom mass*${gy}*(x>${L})
#variable fy atom mass*${gy}*(-(x<${L}))
fix reverce_periodic all addforce 0.0 v_fy 0.0 


variable        Nfreq   equal  ${ntime}
variable        Nrepeat equal  round(0.1*${ntime})
fix av_vy all ave/spatial 1 ${Nrepeat} ${Nfreq} x center 1.0 vy file "vy.av"

neighbor           3.0e-5 bin

variable           dt equal 0.125*${h}^2/${sdpd_eta}
timestep           ${dt}

run		${ntime} every 10 "velocity all zero linear " &
"velocity all zero angular"
