# a function to caclulate time step for SDPD simulation

if "${vsoudn} == 0" then &
"variable dt_vsound equal 1e20" else &
"variable dt_vsound equal 0.25*${sdpd_cutoff}/${vsoudn}"

if "${eta} == 0" then & 
"variable dt_eta equal 1e20" else &
"variable dt_eta equal 0.125*${sdpd_cutoff}*${sdpd_cutoff}/${eta}"

print "dt_eta, dt_vsound: ${dt_eta} ${dt_vsound}"

if "${dt_vsound} < ${dt_eta}" then &
"variable dt equal 0.0001*${dt_vsound}" else & 
"variable dt equal 0.0001*${dt_eta}"
